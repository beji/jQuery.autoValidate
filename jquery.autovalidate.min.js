/*
 * jQuery.autoValidate
 * https://github.com/beji/jQuery.autoValidate
 *
 * Requires jQuery
 * http://jquery.com/
 *
 * Copyright 2013 Bjoern Erlwein
 * Released under the MIT license
 *
 */
(function(b){var a=function(){this.returnJson={};this.validations={}},c;a.prototype.addValidation=function(e,d){if(typeof d==="function"){this.validations[e]=d}e=e.charAt(0).toUpperCase()+e.slice(1);this["validate"+e]=d};a.prototype.addInvalidElement=function(e,d,f){this.returnJson[e]={type:d,error:f}};a.prototype.isValidation=function(d){d=d.charAt(0).toUpperCase()+d.slice(1);return(typeof this["validate"+d]==="function")};a.prototype.validate=function(e){var d,f;this.returnJson={};f=this;d=function(h){var g;h.children().each(function(i,j){j=b(j);if(j.children().length>0){d(j)}g=j.attr("data-validation");if(g!==undefined&&f.isValidation(g)){g=g.charAt(0).toUpperCase()+g.slice(1);f["validate"+g](j)}})};d(e);return this.returnJson};c=new a();c.addValidation("radio",function(e){var d=e.attr("name");if(!(b("input:radio[name='"+d+"']").is(":checked"))){this.addInvalidElement(d,"radio","unchecked");return false}return true});c.addValidation("string",function(d){if(d.val().trim()===""){this.addInvalidElement(d.attr("name"),"input_string","empty");return false}return true});c.addValidation("email",function(e){var d=/^[_a-zA-Z0-9\-]+(\.[_a-zA-Z0-9\-]+)*@[a-zA-Z0-9\-]+(\.[a-zA-Z0-9\-]+)*(\.([a-zA-Z]){2,4})$/;if(e.val().trim()===""&&!e.hasClass("optional")){this.addInvalidElement(e.attr("name"),"input_email","empty");return false}if(!d.exec(e.val())&&e.val().trim()!==""){this.addInvalidElement(e.attr("name"),"input_email","invalid");return false}return true});c.addValidation("epost",function(e){var d=/@epost\.de$/;this.validateEmail(e);if(d.exec(e.val().toLowerCase())){this.addInvalidElement(e.attr("name"),"input_email","epost");return false}return true});c.addValidation("checkbox",function(d){if(!(d.is(":checked"))){this.addInvalidElement(d.attr("name"),"checkbox","unchecked");return false}return true});c.addValidation("number",function(d){if(d.val().trim()===""&&!d.hasClass("optional")){this.addInvalidElement(d.attr("name"),"input_number","empty");return false}if(isNaN(d.val())&&d.val().trim()!==""){this.addInvalidElement(d.attr("name"),"input_number","not a number");return false}return true});window.formValidator=c;window.validateForm=function(d){return c.validate(d)};b.fn.autoValidate=function(e){var d;e=b.extend({validationMessageAttribute:"data-validation",defaultValidationMessageType:"container",validationMessageContainerClass:"validationMessages",validationCallbackAttribute:"data-validation-callback",defaultCallbackFunction:"submit",callback:null,addErrorClass:true,generalErrorMessage:"Please correct your input"},e||{});d=function(){var p,l,f,g,k,o,n,j,i,h,m;p=b(this);if(p.hasClass("noErrorClass")){e.addErrorClass=false}l=c.validate(p);f=p.attr(e.validationMessageAttribute)||e.defaultValidationMessageType;g=p.find("."+e.validationMessageContainerClass);if(e.addErrorClass){b(".validateForm .error, .autoValidate .error").removeClass("error")}if(f==="container"){if(g.length!==0){g.hide()}p.find(".customErrorContainer").hide()}k=e.generalErrorMessage;if(!b.isEmptyObject(l)){for(o in l){if(l.hasOwnProperty(o)){if(e.addErrorClass){n=b("[name='"+o+"']");n.addClass("error");b("label[for='"+n.attr("id")+"']").addClass("error")}if(f==="container"){j=l[o].error;if(p.find(".customErrorContainer[data-for='"+o+"'][data-errortype='"+j+"']").length>0){p.find(".customErrorContainer[data-for='"+o+"'][data-errortype='"+j+"']").show()}else{if(p.find(".customErrorContainer[data-for='"+o+"']").not("[data-errortype]").length>0){p.find(".customErrorContainer[data-for='"+o+"']").not("[data-errortype]").show()}}}else{if(f==="alert"){j=l[o].error;if(p.find(".customErrorContainer[data-for='"+o+"'][data-errortype='"+j+"']").length>0){k=p.find(".customErrorContainer[data-for='"+o+"'][data-errortype='"+j+"']").text()}else{if(p.find(".customErrorContainer[data-for='"+o+"']").not("[data-errortype]").length>0){k=p.find(".customErrorContainer[data-for='"+o+"']").not("[data-errortype]").text()}}if(k!==e.generalErrorMessage){break}}}}}if(f==="alert"){alert(k)}else{if(f==="container"){if(g.length===0){g.text(e.generalErrorMessage)}g.show()}}return false}i=p.attr(e.validationCallbackAttribute)||e.defaultCallbackFunction;h=e.callback||window[i];if(typeof h==="function"){m=h();return(m!==null&&m!==undefined)?m:true}return true};this.unbind("submit");this.bind("submit",d);return this}}(jQuery));
